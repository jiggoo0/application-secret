<!doctype html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lottery Generator - Stable Fixed Version</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
        background: #f0f0f0;
        transition: 0.3s;
      }
      .dark {
        background: #1b1b1b;
        color: #eaeaea;
      }
      .section {
        background: #fff;
        margin-bottom: 20px;
        padding: 15px;
        border-radius: 10px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .dark .section {
        background: #2a2a2a;
      }
      input {
        width: 100px;
        padding: 6px;
        border-radius: 5px;
        border: 1px solid #ccc;
      }
      button {
        padding: 10px 18px;
        font-size: 15px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        background: #007bff;
        color: #fff;
        margin-right: 6px;
      }
      button:hover {
        background: #005fce;
      }
      #historyBox {
        max-height: 200px;
        overflow-y: auto;
        background: #fff;
        padding: 10px;
        border-radius: 6px;
      }
    </style>
  </head>
  <body>
    <h1>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏™‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 0-999 (‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£‡πÅ‡∏Å‡πâ‡πÅ‡∏•‡πâ‡∏ß)</h1>

    <button onclick="toggleTheme()">‡∏™‡∏•‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î Dark/Light</button>

    <div class="section">
      <h2>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå</h2>
      <label
        >‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏ï‡∏¥‡∏î‡πÄ‡∏•‡∏Ç 3 ‡∏ï‡∏±‡∏ß:
        <input id="p3" type="number" value="10" min="0" max="100" /></label
      >%<br />
      <label
        >‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏ï‡∏¥‡∏î‡πÄ‡∏•‡∏Ç 2 ‡∏ï‡∏±‡∏ß:
        <input id="p2" type="number" value="20" min="0" max="100" /></label
      >%<br />
      <label
        >‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏ï‡∏¥‡∏î‡πÄ‡∏•‡∏Ç 1 ‡∏ï‡∏±‡∏ß:
        <input id="p1" type="number" value="30" min="0" max="100" /></label
      >%<br />
      <label
        >‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏ï‡∏¥‡∏î‡πÅ‡∏à‡πá‡∏Ñ‡∏û‡∏≠‡∏ï: <input id="pj" type="number" value="5" min="0" max="100" /></label
      >%
    </div>

    <div class="section">
      <h2>‡∏•‡πá‡∏≠‡∏Ñ‡πÄ‡∏•‡∏Ç‡∏ï‡∏≤‡∏°‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</h2>
      <label>‡∏•‡πá‡∏≠‡∏Ñ‡πÄ‡∏•‡∏Ç 3 ‡∏ï‡∏±‡∏ß: <input id="lock3" maxlength="3" placeholder="000" /></label><br />
      <label>‡∏•‡πá‡∏≠‡∏Ñ‡πÄ‡∏•‡∏Ç 2 ‡∏ï‡∏±‡∏ß: <input id="lock2" maxlength="2" placeholder="00" /></label><br />
      <label>‡∏•‡πá‡∏≠‡∏Ñ‡πÄ‡∏•‡∏Ç 1 ‡∏ï‡∏±‡∏ß: <input id="lock1" maxlength="1" placeholder="0" /></label><br />
      <label>‡∏•‡πá‡∏≠‡∏Ñ‡πÅ‡∏à‡πá‡∏Ñ‡∏û‡∏≠‡∏ï: <input id="lockj" maxlength="3" placeholder="000" /></label>
    </div>

    <button onclick="generate()">‡∏™‡∏∏‡πà‡∏°‡∏ú‡∏•</button>
    <button onclick="copyResult()">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏ú‡∏•</button>
    <button onclick="exportTxt()">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î TXT</button>

    <div id="output" class="section"></div>

    <div class="section">
      <h2>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°</h2>
      <div id="historyBox"></div>
    </div>

    <script>
      let historyList = [];

      function toggleTheme() {
        document.body.classList.toggle('dark');
      }

      function rand(max) {
        return Math.floor(Math.random() * (max + 1));
      }

      function format(n, d) {
        return n.toString().padStart(d, '0');
      }

      function sanitize(value, d) {
        if (!value) return null;
        return value.replace(/\D/g, '').padStart(d, '0').slice(-d);
      }

      function roll(percent, locked, max, digits) {
        if (locked && Math.random() * 100 < percent) return locked;
        return format(rand(max), digits);
      }

      function noDuplicateGenerate(times, func) {
        const set = new Set();
        while (set.size < times) set.add(func());
        return [...set];
      }

      function generate() {
        const p3 = Number(document.getElementById('p3').value);
        const p2 = Number(document.getElementById('p2').value);
        const p1 = Number(document.getElementById('p1').value);
        const pj = Number(document.getElementById('pj').value);

        const l3 = sanitize(document.getElementById('lock3').value, 3);
        const l2 = sanitize(document.getElementById('lock2').value, 2);
        const l1 = sanitize(document.getElementById('lock1').value, 1);
        const lj = sanitize(document.getElementById('lockj').value, 3);

        const three = noDuplicateGenerate(5, () => roll(p3, l3, 999, 3));
        const two = noDuplicateGenerate(10, () => roll(p2, l2, 99, 2));
        const one = [roll(p1, l1, 9, 1)];
        const jackpot = [roll(pj, lj, 999, 3)];

        const result = `‡πÄ‡∏•‡∏Ç 3 ‡∏ï‡∏±‡∏ß: ${three.join(', ')}\n‡πÄ‡∏•‡∏Ç 2 ‡∏ï‡∏±‡∏ß: ${two.join(', ')}\n‡πÄ‡∏•‡∏Ç 1 ‡∏ï‡∏±‡∏ß: ${one}\n‡πÅ‡∏à‡πá‡∏Ñ‡∏û‡∏≠‡∏ï: ${jackpot}`;

        document.getElementById('output').innerHTML = `
        <h2>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°</h2>
        <div>‡πÄ‡∏•‡∏Ç 3 ‡∏ï‡∏±‡∏ß (5 ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•): ${three.join(', ')}</div>
        <div>‡πÄ‡∏•‡∏Ç 2 ‡∏ï‡∏±‡∏ß (10 ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•): ${two.join(', ')}</div>
        <div>‡πÄ‡∏•‡∏Ç 1 ‡∏ï‡∏±‡∏ß (1 ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•): ${one}</div>
        <div style="font-size:22px;color:red;margin-top:10px;">üí• ‡πÅ‡∏à‡πá‡∏Ñ‡∏û‡∏≠‡∏ï: ${jackpot}</div>
      `;

        historyList.unshift(result);
        updateHistory();
      }

      function updateHistory() {
        document.getElementById('historyBox').innerHTML = historyList
          .map(
            (r) =>
              `<div style='margin-bottom:8px;border-bottom:1px solid #ccc;padding-bottom:5px;'>${r.replace(/\n/g, '<br>')}</div>`,
          )
          .join('');
      }

      function copyResult() {
        const text = historyList[0] || '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏™‡∏∏‡πà‡∏°';
        navigator.clipboard.writeText(text);
        alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏ú‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!');
      }

      function exportTxt() {
        const text = historyList.join('\n-----------------------\n');
        const blob = new Blob([text], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'lottery_results.txt';
        a.click();
      }
    </script>
  </body>
</html>
