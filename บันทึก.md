1. ฝั่ง Web (Next.js / Authority)

ตำแหน่ง: app/api/documents/ + app/verify/[token]

ไฟล์ หน้าที่

app/api/documents/generate/route.ts สร้างเอกสาร + qr_token + บันทึก DB
app/api/documents/verify/[token]/route.ts ตรวจสอบ QR token → คืนสถานะ
app/api/documents/update-status/route.ts เปลี่ยน status (pending/paid/verified/revoked)
app/verify/[token]/page.tsx Public UI สำหรับสแกน QR → ดูสถานะ
lib/documents.ts shared logic: create / verify / update document
lib/qr.ts shared logic: token encode/decode
Supabase Table: documents เก็บ document_id, qr_token, status, pdf_url, ref_id, created_at

---

2. ฝั่ง PDF Engine (Document Folder)

ตำแหน่ง: ~/เอกสาร

ไฟล์ หน้าที่

generate_pdf.js Entry point รับ payload → render PDF → embed QR → export PDF
qr.js สร้าง QR image จาก qr_token
pdf_layout_blocks.js Layout หลัก (header/body/footer/QR block)
pdf_styles.js Fonts, margin, style
blocks/qr_block.js Block แสดง QR ใน PDF
templates/invoice.js Template เอกสาร Invoice
templates/receipt.js Template Receipt
templates/booking.js Template Booking
templates/visa.js Template Visa
fonts/ ฟอนต์ TTF ที่ฝังใน PDF
images/, logos/ Asset สำหรับ PDF
mock_data.js (optional) Dev/test data

---

3. Minimum Set ที่ต้องมี

เพื่อให้ระบบ สร้าง → QR → Verify ทำงานได้:

1. API Route: generate / verify / update-status

2. Table documents

3. Verify Page [token]/page.tsx

4. PDF Engine: generate_pdf.js + qr.js + layout + block

5. Templates + Fonts + QR block
